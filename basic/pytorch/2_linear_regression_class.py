# -*- coding: utf-8 -*-
"""2_linear_regression_class로구현.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1kknXnB8vPkL44PHC8CIVZrIIy5UPM8xO
"""

import torch
import torch.nn as nn
import torch.nn.functional as F

"""### **선형회귀를 위한 클래스**

![스크린샷 2022-09-16 오후 9.24.22.png](data:image/png;base64,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)
"""

# torch.nn.Module을 상속받는 토치 클래스
class LinearRegressionModel(nn.Module):
    #클래스안에 기본적으로 멤버 함수는 최소 2개 선언

    # 클래스의 객체를 선언할때 실행되는 함수
    def __init__(self):
        # 부모 클래스인 nn.Module클래스의 초기화 함수를 호출
        super().__init__()
        # 선형회귀 : 입력 노드 = 1, 출력 노드 = 1
        self.linear = nn.Linear(1,1)  
        #print("called : __init__ ")

    def forward(self, x):
        return self.linear(x)

# 랜덤시드값을 고정
torch.manual_seed(123)

"""### 1. 훈련데이터셋 생성"""

# y = 2x + 1
x_train = torch.FloatTensor([[1],[2],[3]])
y_train = torch.FloatTensor([[3],[5],[7]])

"""### 2. 모델 생성"""

# LinearRegressionModel 클래스의 객체 model을 생성
model = LinearRegressionModel()

LR = 0.01

optimizer = torch.optim.SGD(model.parameters(), lr=LR)

epochs = 3000

for epoch in range(epochs+1):
    # model에 입력으로 x_train을 사용
    y_pred = model(x_train)

    # Loss값을 계산(pytorch에서 제공하는 MSE를 사용)
    Loss = F.mse_loss(y_pred, y_train)

    # optimizer를 사용하여 파라메터 최적화
    optimizer.zero_grad()
    Loss.backward()
    optimizer.step()

    if epoch % 100==0:
        print('epoch {:4d}/{}, Loss: {:.6f}'.format(epoch, epochs, Loss.item()))

